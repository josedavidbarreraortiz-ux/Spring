<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="layouts/admin-layout :: layout(~{::title}, ~{::content})">

<head>
    <title>Detalle Venta</title>
</head>

<body>

    <section th:fragment="content">

        <h2 class="mb-3">Detalle de Venta</h2>

        <div class="card shadow-sm">
            <div class="card-body">

                <div class="row">
                    <div class="col-md-6">
                        <p><strong>ID Venta:</strong> <span th:text="${venta.ventaId}"></span></p>
                        <p><strong>Cliente:</strong>
                            <span th:text="${venta.cliente != null ? venta.cliente.user.name : 'N/A'}"></span>
                        </p>
                        <p><strong>MÃ©todo de Pago:</strong>
                            <span
                                th:text="${venta.metodoPago != null ? venta.metodoPago.metodoPagoNombre : 'N/A'}"></span>
                        </p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Fecha:</strong>
                            <span th:text="${venta.ventaFecha}"></span>
                        </p>
                        <p><strong>Hora:</strong>
                            <span th:text="${venta.ventaHora}"></span>
                        </p>
                        <p><strong>Usuario:</strong>
                            <span th:text="${venta.user != null ? venta.user.name : 'N/A'}"></span>
                        </p>
                    </div>
                </div>

                <div th:if="${venta.observaciones != null && venta.observaciones != ''}" class="mt-3">
                    <p><strong>Observaciones:</strong></p>
                    <p th:text="${venta.observaciones}"></p>
                </div>

                <hr>

                <h5>Productos</h5>
                <table class="table table-bordered" th:if="${venta.detalles != null && venta.detalles.size() > 0}">
                    <thead class="table-light">
                        <tr>
                            <th>Producto</th>
                            <th>Cantidad</th>
                            <th>Valor Unitario</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr th:each="d : ${venta.detalles}">
                            <td th:text="${d.producto != null ? d.producto.productoNombre : 'N/A'}"></td>
                            <td th:text="${d.ventaDetalleCantidad}"></td>
                            <td th:text="'$' + ${d.ventaDetallePrecioVenta}"></td>
                            <td th:text="'$' + ${d.ventaDetalleCantidad * d.ventaDetallePrecioVenta}"></td>
                        </tr>
                    </tbody>

                </table>

                <p th:if="${venta.detalles == null || venta.detalles.size() == 0}" class="text-muted">
                    No hay detalles de productos para esta venta
                </p>

                <h4 class="text-end mt-3">
                    Total: $<span th:text="${venta.ventaTotal}"></span>
                </h4>

                <a th:href="@{/admin/ventas}" class="btn btn-secondary mt-3">
                    Volver
                </a>

            </div>
        </div>

    </section>

</body>

</html>